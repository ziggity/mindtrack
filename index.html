<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindTrack - Your Personal Wellness Journal</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* --- General Styling & Setup --- */
        :root {
            --primary-color: #3B82F6; /* Blue 500 */
            --primary-light: #EFF6FF; /* Blue 50 */
            --secondary-color: #10B981; /* Emerald 500 */
            --text-dark: #1F2937; /* Gray 800 */
            --text-light: #6B7280; /* Gray 500 */
            --bg-color: #F9FAFB; /* Gray 50 */
            --border-color: #E5E7EB; /* Gray 200 */
            --white: #FFFFFF;
            --font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--text-dark);
            line-height: 1.6;
        }

        /* --- Layout & Structure --- */
        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: var(--white);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 0;
            text-align: center;
            margin-bottom: 2rem;
        }

        header h1 {
            color: var(--primary-color);
            font-size: 2.5rem;
        }

        nav {
            position: sticky;
            top: 0;
            background: var(--white);
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
        }

        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            padding: 1rem 0;
        }

        nav ul li a {
            text-decoration: none;
            color: var(--text-light);
            padding: 0.5rem 1.5rem;
            font-weight: 600;
            transition: color 0.3s ease, background-color 0.3s ease;
            border-radius: 20px;
        }

        nav ul li a:hover, nav ul li a.active {
            color: var(--primary-color);
            background-color: var(--primary-light);
        }

        section {
            background: var(--white);
            margin-bottom: 2rem;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        h2 {
            font-size: 1.8rem;
            color: var(--text-dark);
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 0.5rem;
        }

        h3 {
            font-size: 1.2rem;
            color: var(--text-dark);
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        
        button {
            background-color: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            display: block;
            width: 100%;
        }

        button:hover {
            background-color: #2563EB; /* Blue 600 */
        }
        
        textarea {
            width: 100%;
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
        }

        /* --- Dashboard: Mood & Health Tracker --- */
        .mood-selector {
            display: flex;
            justify-content: space-around;
            margin-bottom: 1.5rem;
        }

        .mood-option {
            cursor: pointer;
            font-size: 2.5rem;
            padding: 0.5rem;
            border-radius: 50%;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            border: 3px solid transparent;
        }

        .mood-option:hover {
            transform: scale(1.1);
        }
        
        .mood-option.selected {
            border-color: var(--primary-color);
            background-color: var(--primary-light);
        }

        .health-log {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }
        
        .health-log label {
            display: flex;
            align-items: center;
            background: var(--bg-color);
            padding: 0.75rem;
            border-radius: 6px;
            cursor: pointer;
        }

        .health-log input[type="checkbox"] {
            margin-right: 0.75rem;
            width: 18px;
            height: 18px;
        }

        #notes {
            min-height: 120px;
        }
        
        #entry-date-display {
            font-weight: 600;
            color: var(--text-light);
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
        }
        
        #save-entry {
             margin-top: 1rem;
        }

        /* --- Calendar Section --- */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        #month-year {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .calendar-nav {
            background: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-grid div {
            text-align: center;
            padding: 0.75rem 0.25rem;
            border-radius: 4px;
        }
        
        .weekday {
            font-weight: 600;
            color: var(--text-light);
        }

        .day {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .day:hover {
            background-color: var(--primary-light);
        }
        
        .day.empty {
            cursor: default;
        }
        .day.empty:hover {
            background-color: transparent;
        }

        .day.today {
            background-color: var(--secondary-color);
            color: var(--white);
            font-weight: 700;
        }
        
        .day.selected-day {
            outline: 2px solid var(--primary-color);
            background-color: var(--primary-light);
        }

        .day.has-entry {
            position: relative;
        }
        
        .day.has-entry::after {
            content: '';
            position: absolute;
            bottom: 6px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: var(--primary-color);
        }
        
        .day.today.has-entry::after {
             background-color: var(--white);
        }
        
        /* --- NEW: Journal Section --- */
        #journal-entry {
            min-height: 150px;
            margin-bottom: 1rem;
        }
        .journal-log-container {
            margin-top: 2rem;
            max-height: 500px;
            overflow-y: auto;
            border-top: 1px solid var(--border-color);
        }
        .journal-post {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        .journal-post:last-child {
            border-bottom: none;
        }
        .journal-post-date {
            font-weight: 600;
            color: var(--text-light);
            margin-bottom: 0.5rem;
        }
        .journal-post-content {
            white-space: pre-wrap; /* Preserves line breaks */
        }

        /* --- Chart Section --- */
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
            margin-bottom: 3rem;
        }

        /* --- Guides & Resources --- */
        .accordion-item {
            border-bottom: 1px solid var(--border-color);
        }

        .accordion-header {
            width: 100%;
            background: none;
            border: none;
            text-align: left;
            padding: 1.25rem;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .accordion-header::after {
            content: '+';
            font-size: 1.5rem;
            color: var(--primary-color);
            transition: transform 0.3s ease;
        }

        .accordion-header.active::after {
            transform: rotate(45deg);
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
            padding: 0 1.25rem;
        }
        
        /* --- Footer --- */
        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-light);
            font-size: 0.9rem;
        }
    </style>
</head>
<body>

    <header>
        <h1>MindTrack</h1>
    </header>

    <nav>
        <ul>
            <li><a href="#dashboard" class="active">Dashboard</a></li>
            <li><a href="#journal">Journal</a></li>
            <li><a href="#calendar">Calendar</a></li>
            <li><a href="#trends">Trends</a></li>
            <li><a href="#guides">Guides</a></li>
        </ul>
    </nav>

    <main class="container">
        <section id="dashboard">
            <h2>Today's Check-in</h2>
            <p id="entry-date-display"></p>

            <h3>How are you feeling today?</h3>
            <div class="mood-selector">
                <span class="mood-option" data-mood="awful" title="Awful">😞</span>
                <span class="mood-option" data-mood="bad" title="Bad">😟</span>
                <span class="mood-option" data-mood="okay" title="Okay">😐</span>
                <span class="mood-option" data-mood="good" title="Good">😊</span>
                <span class="mood-option" data-mood="great" title="Great">😄</span>
            </div>

            <h3>Health Log</h3>
            <div class="health-log">
                <label><input type="checkbox" id="sleep"> Good Sleep (7+ hrs)</label>
                <label><input type="checkbox" id="exercise"> Exercise</label>
                <label><input type="checkbox" id="meditate"> Meditated</label>
                <label><input type="checkbox" id="socialize"> Socialized</label>
                <label><input type="checkbox" id="medication"> Took Medication</label>
                <label><input type="checkbox" id="hydrate"> Hydrated Well</label>
            </div>

            <h3>Quick Notes</h3>
            <textarea id="notes" placeholder="Any brief notes for today? (Triggers, accomplishments, etc.)"></textarea>

            <button id="save-entry">Save Daily Check-in</button>
        </section>
        
        <section id="journal">
            <h2>Journal</h2>
            <h3>New Entry</h3>
            <textarea id="journal-entry" placeholder="Write about your day, your thoughts, and your feelings..."></textarea>
            <button id="save-journal-entry">Save Journal Entry</button>
            
            <div class="journal-log-container">
                <h3>Past Entries</h3>
                <div id="journal-log">
                    </div>
            </div>
        </section>

        <section id="calendar">
            <h2>Your Progress Calendar</h2>
            <div class="calendar-header">
                <button class="calendar-nav" id="prev-month">&lt; Prev</button>
                <span id="month-year"></span>
                <button class="calendar-nav" id="next-month">Next &gt;</button>
            </div>
            <div class="calendar-grid weekdays">
                <div class="weekday">Sun</div> <div class="weekday">Mon</div> <div class="weekday">Tue</div> <div class="weekday">Wed</div> <div class="weekday">Thu</div> <div class="weekday">Fri</div> <div class="weekday">Sat</div>
            </div>
            <div class="calendar-grid" id="calendar-days"></div>
        </section>

        <section id="trends">
            <h2>Trends & Analytics</h2>
            <h3>Mood Over Time</h3>
            <div class="chart-container"><canvas id="moodChart"></canvas></div>
            <h3>Health Habit Frequency</h3>
            <div class="chart-container"><canvas id="healthHabitChart"></canvas></div>
        </section>

        <section id="guides">
            <h2>Guides & Resources</h2>
            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">Cognitive Behavioral Therapy (CBT) Guides</button>
                    <div class="accordion-content">
                        <h4>What is CBT?</h4>
                        <p>CBT helps you identify and challenge negative thought patterns. The goal is to replace them with more objective, realistic thoughts.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Mindfulness Guides</button>
                    <div class="accordion-content">
                        <h4>Mindful Breathing (1-Minute Exercise)</h4>
                        <p>This is a simple technique to ground yourself. Sit comfortably, close your eyes, and focus on the sensation of your breath without trying to change it. If your mind wanders, gently guide it back.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 MindTrack. For personal tracking only.</p>
    </footer>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- STATE MANAGEMENT ---
    let dailyData = JSON.parse(localStorage.getItem('mindTrackDailyData')) || {};
    let journalData = JSON.parse(localStorage.getItem('mindTrackJournalData')) || {};
    let currentDate = new Date();
    let selectedDate = new Date();
    let moodChartInstance = null;
    let healthHabitChartInstance = null;

    // --- DOM ELEMENTS ---
    const moodOptions = document.querySelectorAll('.mood-option');
    const healthCheckboxes = document.querySelectorAll('.health-log input[type="checkbox"]');
    const notesInput = document.getElementById('notes');
    const saveButton = document.getElementById('save-entry');
    const calendarDaysContainer = document.getElementById('calendar-days');
    const monthYearDisplay = document.getElementById('month-year');
    const prevMonthButton = document.getElementById('prev-month');
    const nextMonthButton = document.getElementById('next-month');
    const entryDateDisplay = document.getElementById('entry-date-display');
    const journalEntryInput = document.getElementById('journal-entry');
    const saveJournalButton = document.getElementById('save-journal-entry');
    const journalLogContainer = document.getElementById('journal-log');
    const accordionHeaders = document.querySelectorAll('.accordion-header');

    // --- DATE HELPERS ---
    const toISODateString = (date) => date.toISOString().split('T')[0];
    const formatDisplayDate = (date) => date.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

    // --- DATA HANDLING ---
    const saveDailyData = () => {
        const dateString = toISODateString(selectedDate);
        const selectedMood = document.querySelector('.mood-option.selected');
        
        const healthLog = {};
        healthCheckboxes.forEach(cb => {
            healthLog[cb.id] = cb.checked;
        });

        const entry = {
            mood: selectedMood ? selectedMood.dataset.mood : null,
            health: healthLog,
            notes: notesInput.value,
        };

        dailyData[dateString] = entry;
        localStorage.setItem('mindTrackDailyData', JSON.stringify(dailyData));
        alert('Daily Check-in saved!');
        renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
        renderCharts();
    };
    
    const saveJournalData = () => {
        const entryText = journalEntryInput.value.trim();
        if (!entryText) {
            alert('Journal entry cannot be empty.');
            return;
        }
        const timestamp = new Date().toISOString();
        journalData[timestamp] = entryText;
        localStorage.setItem('mindTrackJournalData', JSON.stringify(journalData));
        journalEntryInput.value = '';
        alert('Journal entry saved!');
        renderJournal();
    };

    const loadDailyDataForDate = (date) => {
        selectedDate = date;
        const dateString = toISODateString(date);
        const data = dailyData[dateString];

        entryDateDisplay.textContent = `Check-in for ${formatDisplayDate(date)}`;
        saveButton.textContent = `Save Check-in for ${date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}`;

        moodOptions.forEach(opt => opt.classList.remove('selected'));
        healthCheckboxes.forEach(cb => cb.checked = false);
        notesInput.value = '';

        if (data) {
            if (data.mood) {
                document.querySelector(`.mood-option[data-mood="${data.mood}"]`)?.classList.add('selected');
            }
            if (data.health) {
                for (const key in data.health) {
                    const cb = document.getElementById(key);
                    if (cb) cb.checked = data.health[key];
                }
            }
            notesInput.value = data.notes || '';
        }
        renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
    };

    // --- UI RENDERING ---
    const renderJournal = () => {
        journalLogContainer.innerHTML = '';
        const sortedEntries = Object.keys(journalData).sort().reverse();
        if (sortedEntries.length === 0) {
            journalLogContainer.innerHTML = '<p>No journal entries yet.</p>';
            return;
        }
        sortedEntries.forEach(timestamp => {
            const entryDate = new Date(timestamp);
            const content = journalData[timestamp];
            
            const postDiv = document.createElement('div');
            postDiv.className = 'journal-post';
            
            const dateP = document.createElement('p');
            dateP.className = 'journal-post-date';
            dateP.textContent = formatDisplayDate(entryDate) + ' at ' + entryDate.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit'});
            
            const contentP = document.createElement('p');
            contentP.className = 'journal-post-content';
            contentP.textContent = content;
            
            postDiv.appendChild(dateP);
            postDiv.appendChild(contentP);
            journalLogContainer.appendChild(postDiv);
        });
    };

    const renderCalendar = (year, month) => {
        calendarDaysContainer.innerHTML = '';
        monthYearDisplay.textContent = `${new Date(year, month).toLocaleString('default', { month: 'long' })} ${year}`;
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const todayString = toISODateString(new Date());
        const selectedDateString = toISODateString(selectedDate);

        for (let i = 0; i < firstDay; i++) {
            calendarDaysContainer.appendChild(Object.assign(document.createElement('div'), { className: 'day empty' }));
        }

        for (let i = 1; i <= daysInMonth; i++) {
            const dayDate = new Date(year, month, i);
            const dayString = toISODateString(dayDate);
            const dayDiv = Object.assign(document.createElement('div'), {
                className: 'day',
                textContent: i,
                dataset: { date: dayString }
            });

            if (dayString === todayString) dayDiv.classList.add('today');
            if (dayString === selectedDateString) dayDiv.classList.add('selected-day');
            if (dailyData[dayString]) dayDiv.classList.add('has-entry');
            
            dayDiv.addEventListener('click', () => loadDailyDataForDate(dayDate));
            calendarDaysContainer.appendChild(dayDiv);
        }
    };
    
    // --- CHART RENDERING ---
    const moodMap = { 'awful': 1, 'bad': 2, 'okay': 3, 'good': 4, 'great': 5 };
    const moodLabels = ['Awful', 'Bad', 'Okay', 'Good', 'Great'];

    const renderCharts = () => {
        const sortedDates = Object.keys(dailyData).sort((a, b) => new Date(a) - new Date(b));

        const moodChartLabels = sortedDates.map(date => new Date(date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
        const moodChartData = sortedDates.map(date => dailyData[date].mood ? moodMap[dailyData[date].mood] : 0);

        const healthHabitCounts = {};
        const healthHabitLabels = Array.from(healthCheckboxes).map(cb => cb.parentElement.textContent.trim());
        healthCheckboxes.forEach(cb => { healthHabitCounts[cb.id] = 0; });

        sortedDates.forEach(date => {
            const entry = dailyData[date];
            if (entry.health) {
                for (const habit in entry.health) {
                    if (entry.health[habit]) healthHabitCounts[habit]++;
                }
            }
        });
        const healthHabitData = Object.values(healthHabitCounts);

        // Render Mood Line Chart
        if (moodChartInstance) moodChartInstance.destroy();
        moodChartInstance = new Chart(document.getElementById('moodChart').getContext('2d'), {
            type: 'line',
            data: {
                labels: moodChartLabels,
                datasets: [{
                    label: 'Mood Trend', data: moodChartData,
                    borderColor: 'rgba(59, 130, 246, 1)',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    tension: 0.1, fill: true
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                scales: { y: { min: 1, max: 5, ticks: { stepSize: 1, callback: (value) => moodLabels[value - 1] } } },
                plugins: { tooltip: { callbacks: { label: (context) => `Mood: ${moodLabels[context.parsed.y - 1]}` } } }
            }
        });

        // Render Health Habit Bar Chart
        if (healthHabitChartInstance) healthHabitChartInstance.destroy();
        healthHabitChartInstance = new Chart(document.getElementById('healthHabitChart').getContext('2d'), {
            type: 'bar',
            data: {
                labels: healthHabitLabels,
                datasets: [{
                    label: 'Total Days Logged', data: healthHabitData,
                    backgroundColor: ['rgba(255, 99, 132, 0.5)', 'rgba(54, 162, 235, 0.5)', 'rgba(255, 206, 86, 0.5)', 'rgba(75, 192, 192, 0.5)', 'rgba(153, 102, 255, 0.5)', 'rgba(255, 159, 64, 0.5)']
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } }, plugins: { legend: { display: false } } }
        });
    };

    // --- EVENT LISTENERS ---
    moodOptions.forEach(option => {
        option.addEventListener('click', () => {
            moodOptions.forEach(opt => opt.classList.remove('selected'));
            option.classList.add('selected');
        });
    });

    saveButton.addEventListener('click', saveDailyData);
    saveJournalButton.addEventListener('click', saveJournalData);
    prevMonthButton.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() - 1);
        renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
    });
    nextMonthButton.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() + 1);
        renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
    });
    accordionHeaders.forEach(header => {
        header.addEventListener('click', () => {
            const content = header.nextElementSibling;
            header.classList.toggle('active');
            if (content.style.maxHeight) {
                content.style.maxHeight = null;
            } else {
                content.style.maxHeight = content.scrollHeight + 'px';
            }
        });
    });

    // --- INITIALIZATION ---
    loadDailyDataForDate(selectedDate);
    renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
    renderCharts();
    renderJournal();
});
</script>

</body>
</html>