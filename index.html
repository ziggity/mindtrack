<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindTrack - Your Personal Wellness Journal</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* --- General Styling & Setup --- */
        :root {
            --primary-color: #3B82F6; /* Blue 500 */
            --primary-light: #EFF6FF; /* Blue 50 */
            --secondary-color: #10B981; /* Emerald 500 */
            --text-dark: #1F2937; /* Gray 800 */
            --text-light: #6B7280; /* Gray 500 */
            --bg-color: #F9FAFB; /* Gray 50 */
            --border-color: #E5E7EB; /* Gray 200 */
            --white: #FFFFFF;
            --font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--text-dark);
            line-height: 1.6;
        }

        /* --- Layout & Structure --- */
        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: var(--white);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 0;
            text-align: center;
            margin-bottom: 2rem;
        }

        header h1 {
            color: var(--primary-color);
            font-size: 2.5rem;
        }

        nav {
            position: sticky;
            top: 0;
            background: var(--white);
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
        }

        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            padding: 1rem 0;
        }

        nav ul li a {
            text-decoration: none;
            color: var(--text-light);
            padding: 0.5rem 1.5rem;
            font-weight: 600;
            transition: color 0.3s ease, background-color 0.3s ease;
            border-radius: 20px;
        }

        nav ul li a:hover, nav ul li a.active {
            color: var(--primary-color);
            background-color: var(--primary-light);
        }

        section {
            background: var(--white);
            margin-bottom: 2rem;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        h2 {
            font-size: 1.8rem;
            color: var(--text-dark);
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 0.5rem;
        }

        h3 {
            font-size: 1.2rem;
            color: var(--text-dark);
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }

        /* --- Dashboard: Mood & Health Tracker --- */
        .mood-selector {
            display: flex;
            justify-content: space-around;
            margin-bottom: 1.5rem;
        }

        .mood-option {
            cursor: pointer;
            font-size: 2.5rem;
            padding: 0.5rem;
            border-radius: 50%;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            border: 3px solid transparent;
        }

        .mood-option:hover {
            transform: scale(1.1);
        }
        
        .mood-option.selected {
            border-color: var(--primary-color);
            background-color: var(--primary-light);
        }

        .health-log {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }
        
        .health-log label {
            display: flex;
            align-items: center;
            background: var(--bg-color);
            padding: 0.75rem;
            border-radius: 6px;
            cursor: pointer;
        }

        .health-log input[type="checkbox"] {
            margin-right: 0.75rem;
            width: 18px;
            height: 18px;
        }

        textarea#notes {
            width: 100%;
            min-height: 120px;
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
        }

        button#save-entry {
            background-color: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            display: block;
            width: 100%;
            margin-top: 1rem;
        }

        button#save-entry:hover {
            background-color: #2563EB; /* Blue 600 */
        }
        
        #entry-date-display {
            font-weight: 600;
            color: var(--text-light);
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
        }

        /* --- Calendar Section --- */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        #month-year {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .calendar-nav {
            background: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-grid div {
            text-align: center;
            padding: 0.75rem 0.25rem;
            border-radius: 4px;
        }
        
        .weekday {
            font-weight: 600;
            color: var(--text-light);
        }

        .day {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .day:hover {
            background-color: var(--primary-light);
        }
        
        .day.empty {
            cursor: default;
        }
        .day.empty:hover {
            background-color: transparent;
        }

        .day.today {
            background-color: var(--secondary-color);
            color: var(--white);
            font-weight: 700;
        }
        
        .day.selected-day {
            outline: 2px solid var(--primary-color);
            background-color: var(--primary-light);
        }

        .day.has-entry {
            position: relative;
        }
        
        .day.has-entry::after {
            content: '';
            position: absolute;
            bottom: 6px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: var(--primary-color);
        }
        
        .day.today.has-entry::after {
             background-color: var(--white);
        }

        /* --- Guides & Resources --- */
        .accordion-item {
            border-bottom: 1px solid var(--border-color);
        }

        .accordion-header {
            width: 100%;
            background: none;
            border: none;
            text-align: left;
            padding: 1.25rem;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .accordion-header::after {
            content: '+';
            font-size: 1.5rem;
            color: var(--primary-color);
            transition: transform 0.3s ease;
        }

        .accordion-header.active::after {
            transform: rotate(45deg);
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
            padding: 0 1.25rem;
        }

        .accordion-content p, .accordion-content ul {
            margin-bottom: 1rem;
        }

        .accordion-content ul {
            padding-left: 20px;
        }
        
        /* --- Chart Section --- */
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
            margin-bottom: 3rem;
        }
        
        /* --- Footer --- */
        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-light);
            font-size: 0.9rem;
        }
    </style>
</head>
<body>

    <header>
        <h1>MindTrack</h1>
    </header>

    <nav>
        <ul>
            <li><a href="#dashboard" class="active">Dashboard</a></li>
            <li><a href="#calendar">Calendar</a></li>
            <li><a href="#trends">Trends</a></li>
            <li><a href="#guides">Guides</a></li>
        </ul>
    </nav>

    <main class="container">
        <section id="dashboard">
            <h2>Today's Check-in</h2>
            <p id="entry-date-display"></p>

            <h3>How are you feeling today?</h3>
            <div class="mood-selector">
                <span class="mood-option" data-mood="awful" title="Awful">üòû</span>
                <span class="mood-option" data-mood="bad" title="Bad">üòü</span>
                <span class="mood-option" data-mood="okay" title="Okay">üòê</span>
                <span class="mood-option" data-mood="good" title="Good">üòä</span>
                <span class="mood-option" data-mood="great" title="Great">üòÑ</span>
            </div>

            <h3>Health Log</h3>
            <div class="health-log">
                <label><input type="checkbox" id="sleep" value="good_sleep"> Good Sleep (7+ hrs)</label>
                <label><input type="checkbox" id="exercise" value="exercise"> Exercise</label>
                <label><input type="checkbox" id="meditate" value="meditate"> Meditated</label>
                <label><input type="checkbox" id="socialize" value="socialize"> Socialized</label>
                <label><input type="checkbox" id="medication" value="medication"> Took Medication</label>
                <label><input type="checkbox" id="hydrate" value="hydrate"> Hydrated Well</label>
            </div>

            <h3>Notes & Thoughts</h3>
            <textarea id="notes" placeholder="What's on your mind? Any triggers, accomplishments, or feelings to note?"></textarea>

            <button id="save-entry">Save Today's Entry</button>
        </section>

        <section id="calendar">
            <h2>Your Progress Calendar</h2>
            <div class="calendar-header">
                <button class="calendar-nav" id="prev-month">&lt; Prev</button>
                <span id="month-year"></span>
                <button class="calendar-nav" id="next-month">Next &gt;</button>
            </div>
            <div class="calendar-grid weekdays">
                <div class="weekday">Sun</div>
                <div class="weekday">Mon</div>
                <div class="weekday">Tue</div>
                <div class="weekday">Wed</div>
                <div class="weekday">Thu</div>
                <div class="weekday">Fri</div>
                <div class="weekday">Sat</div>
            </div>
            <div class="calendar-grid" id="calendar-days"></div>
        </section>

        <section id="trends">
            <h2>Trends & Analytics</h2>
            
            <h3>Mood Over Time</h3>
            <div class="chart-container">
                <canvas id="moodChart"></canvas>
            </div>

            <h3>Health Habit Frequency</h3>
            <div class="chart-container">
                <canvas id="healthHabitChart"></canvas>
            </div>
        </section>


        <section id="guides">
            <h2>Guides & Resources</h2>
            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">Cognitive Behavioral Therapy (CBT) Guides</button>
                    <div class="accordion-content">
                        <h4>What is CBT?</h4>
                        <p>CBT helps you identify and challenge negative thought patterns (cognitive distortions) and behaviors. The goal is to replace them with more objective, realistic thoughts.</p>
                        <h4>The 3 C's Technique:</h4>
                        <ul>
                            <li><strong>Catch It:</strong> Identify the negative thought as it happens. (e.g., "I'm going to fail this presentation.")</li>
                            <li><strong>Check It:</strong> Reflect on the thought. Is it 100% true? What's the evidence for and against it? What's a more balanced perspective? (e.g., "I'm nervous, but I've prepared. I've done well before. It's not a catastrophe if it's not perfect.")</li>
                            <li><strong>Change It:</strong> Replace the negative thought with a more realistic and constructive one. (e.g., "I am prepared for this presentation and I will do my best.")</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Mindfulness Guides</button>
                    <div class="accordion-content">
                        <h4>Mindful Breathing (1-Minute Exercise)</h4>
                        <p>This is a simple but powerful technique to ground yourself anytime you feel overwhelmed.</p>
                        <ul>
                            <li>Sit or stand comfortably. Close your eyes if you wish.</li>
                            <li>Bring your attention to your breath. Notice the sensation of air entering your nostrils and filling your lungs.</li>
                            <li>Notice the sensation of your chest or belly rising and falling.</li>
                            <li>Don't try to change your breath, just observe it.</li>
                            <li>If your mind wanders, gently guide it back to your breath. That's the practice!</li>
                            <li>Continue for one minute.</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">General Health & Wellness Tips</button>
                    <div class="accordion-content">
                        <ul>
                            <li><strong>Stay Hydrated:</strong> Dehydration can impact mood and cognitive function. Aim for about 8 glasses of water a day.</li>
                            <li><strong>Move Your Body:</strong> Even a 15-minute walk can boost your mood and energy levels. Find an activity you enjoy.</li>
                            <li><strong>Prioritize Sleep:</strong> Aim for a consistent sleep schedule, even on weekends. Create a relaxing bedtime routine to signal to your body that it's time to wind down.</li>
                            <li><strong>Connect with Others:</strong> Social connection is a powerful buffer against stress. Reach out to a friend or family member.</li>
                            <li><strong>Eat Nourishing Foods:</strong> A balanced diet rich in fruits, vegetables, and whole grains can have a significant positive effect on your mental and physical health.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 MindTrack. For personal tracking purposes only. Not a substitute for professional medical advice.</p>
    </footer>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- STATE MANAGEMENT ---
    let appData = JSON.parse(localStorage.getItem('mindTrackData')) || {};
    let currentDate = new Date();
    let selectedDate = new Date();
    let moodChartInstance = null;
    let healthHabitChartInstance = null;

    // --- DOM ELEMENTS ---
    const moodOptions = document.querySelectorAll('.mood-option');
    const healthCheckboxes = document.querySelectorAll('.health-log input[type="checkbox"]');
    const notesInput = document.getElementById('notes');
    const saveButton = document.getElementById('save-entry');
    const calendarDaysContainer = document.getElementById('calendar-days');
    const monthYearDisplay = document.getElementById('month-year');
    const prevMonthButton = document.getElementById('prev-month');
    const nextMonthButton = document.getElementById('next-month');
    const entryDateDisplay = document.getElementById('entry-date-display');
    const accordionHeaders = document.querySelectorAll('.accordion-header');

    // --- DATE HELPERS ---
    const toISODateString = (date) => {
        return date.getFullYear() + '-' + String(date.getMonth() + 1).padStart(2, '0') + '-' + String(date.getDate()).padStart(2, '0');
    };

    // --- DATA HANDLING ---
    const saveData = () => {
        const dateString = toISODateString(selectedDate);
        const selectedMood = document.querySelector('.mood-option.selected');
        
        const healthLog = {};
        healthCheckboxes.forEach(cb => {
            healthLog[cb.id] = cb.checked;
        });

        const entry = {
            mood: selectedMood ? selectedMood.dataset.mood : null,
            health: healthLog,
            notes: notesInput.value,
        };

        appData[dateString] = entry;
        localStorage.setItem('mindTrackData', JSON.stringify(appData));
        alert('Entry saved successfully!');
        renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
        renderCharts(); // Re-render charts after saving new data
    };

    const loadDataForDate = (date) => {
        selectedDate = date;
        const dateString = toISODateString(date);
        const data = appData[dateString];

        const isToday = toISODateString(date) === toISODateString(new Date());
        entryDateDisplay.textContent = `Entry for ${date.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}`;
        saveButton.textContent = isToday ? "Save Today's Entry" : `Save Entry for ${date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}`;

        moodOptions.forEach(opt => opt.classList.remove('selected'));
        healthCheckboxes.forEach(cb => cb.checked = false);
        notesInput.value = '';

        if (data) {
            if (data.mood) {
                const moodEl = document.querySelector(`.mood-option[data-mood="${data.mood}"]`);
                if (moodEl) moodEl.classList.add('selected');
            }
            if (data.health) {
                for (const key in data.health) {
                    const cb = document.getElementById(key);
                    if (cb) cb.checked = data.health[key];
                }
            }
            notesInput.value = data.notes || '';
        }
        renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
    };

    // --- UI RENDERING ---
    const renderCalendar = (year, month) => {
        calendarDaysContainer.innerHTML = '';
        monthYearDisplay.textContent = `${new Date(year, month).toLocaleString('default', { month: 'long' })} ${year}`;
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const todayString = toISODateString(new Date());
        const selectedDateString = toISODateString(selectedDate);

        for (let i = 0; i < firstDay; i++) {
            const emptyDiv = document.createElement('div');
            emptyDiv.classList.add('day', 'empty');
            calendarDaysContainer.appendChild(emptyDiv);
        }

        for (let i = 1; i <= daysInMonth; i++) {
            const dayDiv = document.createElement('div');
            const dayDate = new Date(year, month, i);
            const dayString = toISODateString(dayDate);

            dayDiv.classList.add('day');
            dayDiv.textContent = i;
            dayDiv.dataset.date = dayString;

            if (dayString === todayString) dayDiv.classList.add('today');
            if (dayString === selectedDateString) dayDiv.classList.add('selected-day');
            if (appData[dayString]) dayDiv.classList.add('has-entry');
            
            dayDiv.addEventListener('click', () => {
                loadDataForDate(dayDate);
            });
            calendarDaysContainer.appendChild(dayDiv);
        }
    };
    
    // --- CHART RENDERING ---
    const moodMap = {
        'awful': 1, 'bad': 2, 'okay': 3, 'good': 4, 'great': 5
    };
    const moodLabels = ['Awful', 'Bad', 'Okay', 'Good', 'Great'];

    const renderCharts = () => {
        const sortedDates = Object.keys(appData).sort((a, b) => new Date(a) - new Date(b));

        // 1. Prepare data for Mood Chart
        const moodChartLabels = sortedDates.map(date => new Date(date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
        const moodChartData = sortedDates.map(date => appData[date].mood ? moodMap[appData[date].mood] : 0);

        // 2. Prepare data for Health Habit Chart
        const healthHabitCounts = {};
        const healthHabitLabels = Array.from(healthCheckboxes).map(cb => cb.parentElement.textContent.trim());        
        healthCheckboxes.forEach(cb => {
            healthHabitCounts[cb.id] = 0;
        });

        sortedDates.forEach(date => {
            const entry = appData[date];
            if (entry.health) {
                for (const habit in entry.health) {
                    if (entry.health[habit]) {
                        healthHabitCounts[habit]++;
                    }
                }
            }
        });
        const healthHabitData = Object.values(healthHabitCounts);

        // Render Mood Line Chart
        const moodCtx = document.getElementById('moodChart').getContext('2d');
        if (moodChartInstance) {
            moodChartInstance.destroy();
        }
        moodChartInstance = new Chart(moodCtx, {
            type: 'line',
            data: {
                labels: moodChartLabels,
                datasets: [{
                    label: 'Mood Trend',
                    data: moodChartData,
                    borderColor: 'rgba(59, 130, 246, 1)',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    tension: 0.1,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        min: 1,
                        max: 5,
                        ticks: {
                            stepSize: 1,
                            callback: function(value, index, values) {
                                return moodLabels[value - 1];
                            }
                        }
                    }
                },
                plugins: {
                   tooltip: {
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed.y !== null) {
                                    label += moodLabels[context.parsed.y - 1];
                                }
                                return label;
                            }
                        }
                    }
                }
            }
        });

        // Render Health Habit Bar Chart
        const healthCtx = document.getElementById('healthHabitChart').getContext('2d');
        if (healthHabitChartInstance) {
            healthHabitChartInstance.destroy();
        }
        healthHabitChartInstance = new Chart(healthCtx, {
            type: 'bar',
            data: {
                labels: healthHabitLabels,
                datasets: [{
                    label: 'Total Days Logged',
                    data: healthHabitData,
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.5)',
                        'rgba(54, 162, 235, 0.5)',
                        'rgba(255, 206, 86, 0.5)',
                        'rgba(75, 192, 192, 0.5)',
                        'rgba(153, 102, 255, 0.5)',
                        'rgba(255, 159, 64, 0.5)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                           stepSize: 1
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
    };


    // --- EVENT LISTENERS ---
    moodOptions.forEach(option => {
        option.addEventListener('click', () => {
            moodOptions.forEach(opt => opt.classList.remove('selected'));
            option.classList.add('selected');
        });
    });

    saveButton.addEventListener('click', saveData);

    prevMonthButton.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() - 1);
        renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
    });

    nextMonthButton.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() + 1);
        renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
    });
    
    accordionHeaders.forEach(header => {
        header.addEventListener('click', () => {
            const content = header.nextElementSibling;
            header.classList.toggle('active');
            if (content.style.maxHeight) {
                content.style.maxHeight = null;
                content.style.padding = '0 1.25rem';
            } else {
                content.style.padding = '0 1.25rem 1.25rem 1.25rem';
                content.style.maxHeight = content.scrollHeight + 'px';
            }
        });
    });

    // --- INITIALIZATION ---
    loadDataForDate(selectedDate);
    renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
    renderCharts(); // Render charts on initial page load
});
</script>

</body>
</html>